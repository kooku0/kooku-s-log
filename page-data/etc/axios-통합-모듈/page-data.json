{"componentChunkName":"component---src-templates-blog-post-js","path":"/etc/axios-통합-모듈/","result":{"data":{"site":{"siteMetadata":{"title":"Kooku's log","author":"Kooku","siteUrl":"https://kooku.netlify.com","comment":{"disqusShortName":"","utterances":"koomg9599/kooku-s-log"},"sponsor":{"buyMeACoffeeId":"kooku"}}},"markdownRemark":{"id":"435eafc8-9cf3-588a-9e2a-98c8afb17748","excerpt":"이 글을 어디에 쓸지, 제목은 어떻게 해야할지 고민이 많았다. 결국 etc 카테고리에 넣었는데 잘 한건지는..  한달전? 쯤 당근마켓에서 채용공고를 한 적이 있다. 과제를 수행하는 것이였는데 tamplate 는 주어지고, 비어있는 부분의 코드를 짜는 것이였다. 이때 받은  템플릿코드가 너무 좋아서 여기에 포스팅 해보려고 한다. 특히 마음에 들었던 부분은 axios를 이용한 api request, response 부분이였다. 폴더구조는 다음과 같았다.  파일을 보면 알겠지만 typescript…","html":"<blockquote>\n<p> 이 글을 어디에 쓸지, 제목은 어떻게 해야할지 고민이 많았다. 결국 etc 카테고리에 넣었는데 잘 한건지는.. </p>\n</blockquote>\n<p>한달전? 쯤 당근마켓에서 채용공고를 한 적이 있다. 과제를 수행하는 것이였는데 tamplate 는 주어지고, 비어있는 부분의 코드를 짜는 것이였다. 이때 받은  템플릿코드가 너무 좋아서 여기에 포스팅 해보려고 한다.</p>\n<p>특히 마음에 들었던 부분은 axios를 이용한 api request, response 부분이였다.</p>\n<p>폴더구조는 다음과 같았다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token operator\">|</span>services\n<span class=\"token operator\">|</span>--AuthService.ts\n<span class=\"token operator\">|</span>--ProductService.ts\n<span class=\"token operator\">|</span>--types.ts</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// AuthService.ts</span>\n<span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">'axios'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ApiResponse <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'~services/types'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> LoginResponseDto <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  token<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  id<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> LoginSignupRequestDto <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  email<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  password<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> AuthResponseDto <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  id<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  email<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  password<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">API_HOST</span> <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">API_HOST</span> <span class=\"token operator\">||</span> <span class=\"token string\">'http://localhost:5000/api'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">AuthService</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">login</span><span class=\"token punctuation\">(</span>body<span class=\"token operator\">:</span> LoginSignupRequestDto<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>ApiResponse<span class=\"token operator\">&lt;</span>LoginResponseDto<span class=\"token operator\">>></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">API_HOST</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/auth/login</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">signUp</span><span class=\"token punctuation\">(</span>body<span class=\"token operator\">:</span> LoginSignupRequestDto<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>ApiResponse<span class=\"token operator\">&lt;</span>AuthResponseDto<span class=\"token operator\">>></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">API_HOST</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/auth/signup</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> AuthService<span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// ProductService.ts</span>\n<span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">'axios'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ApiResponse <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'~services/types'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> AuthStore <span class=\"token keyword\">from</span> <span class=\"token string\">'~stores/auth/AuthStore'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> ProductRegistrationDto <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  userId<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  image<span class=\"token operator\">:</span> File<span class=\"token punctuation\">;</span>\n  category<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  title<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  description<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  price<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> ProductDto <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  id<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  userId<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  title<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  image<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  category<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  description<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  price<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  createdAt<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  updatedAt<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">API_HOST</span> <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">API_HOST</span> <span class=\"token operator\">||</span> <span class=\"token string\">'http://localhost:5000/api'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ProductService</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token keyword\">private</span> authStore<span class=\"token operator\">:</span> AuthStore</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">registration</span><span class=\"token punctuation\">(</span>body<span class=\"token operator\">:</span> ProductRegistrationDto<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>ApiResponse<span class=\"token operator\">&lt;</span>ProductDto<span class=\"token operator\">>></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>authStore<span class=\"token punctuation\">.</span>auth <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'need to login!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">const</span> formData <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FormData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    formData<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'image'</span><span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">.</span>image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    formData<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'userId'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>authStore<span class=\"token punctuation\">.</span>auth<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    formData<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'category'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">.</span>category<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    formData<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'title'</span><span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    formData<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'description'</span><span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">.</span>description<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    formData<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'price'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">.</span>price<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> axios<span class=\"token punctuation\">.</span>post<span class=\"token operator\">&lt;</span>ProductRegistrationDto<span class=\"token punctuation\">,</span> ApiResponse<span class=\"token operator\">&lt;</span>ProductDto<span class=\"token operator\">>></span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">API_HOST</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/products</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> formData<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      headers<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'Content-Type'</span><span class=\"token operator\">:</span> <span class=\"token string\">'multipart/form-data'</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>ApiResponse<span class=\"token operator\">&lt;</span>ProductDto<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">>></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> axios<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">API_HOST</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/products</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">getById</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>ApiResponse<span class=\"token operator\">&lt;</span>ProductDto<span class=\"token operator\">>></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> axios<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">API_HOST</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/products/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> ProductService<span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// types.ts</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> AxiosResponse <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'axios'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Response</span><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n  data<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">,</span>\n  msg<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> ApiResponse<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> AxiosResponse<span class=\"token operator\">&lt;</span>Response<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">>></span></code></pre></div>\n<p><code class=\"language-text\">types.ts</code> 파일을 보면 알겠지만 typescript의 템플릿을 이용하여 response를 구성하였다. 그리고 data의 interface는 각 서비스 파일에서 만들어 넣어주었다. 진짜 깔끔 그 자체</p>\n<p>여기에서 경로는 다음과 같이 <code class=\"language-text\">constans.ts</code>파일로 따로 뺐는데 <code class=\"language-text\">enum</code>을 이용해서 이쁘게 만들었더라.. </p>\n<p>진짜 많은 걸 배울 수 있는 코드였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// constants.ts</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">enum</span> <span class=\"token constant\">STORES</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">AUTH_STORE</span> <span class=\"token operator\">=</span> <span class=\"token string\">'authStore'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">PRODUCTS_STORE</span> <span class=\"token operator\">=</span> <span class=\"token string\">'productsStore'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">enum</span> <span class=\"token constant\">PAGE_PATHS</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">SIGNUP</span> <span class=\"token operator\">=</span> <span class=\"token string\">'/signup'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">SIGNIN</span> <span class=\"token operator\">=</span> <span class=\"token string\">'/signin'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">PRODUCT_LISTS</span> <span class=\"token operator\">=</span> <span class=\"token string\">'/products'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">PRODUCT_CAR_CATEGORY_LISTS</span> <span class=\"token operator\">=</span> <span class=\"token string\">'/car-products'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">PRODUCT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'/products'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">PRODUCT_REGISTRATION</span> <span class=\"token operator\">=</span> <span class=\"token string\">'/products-registration'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"title":"axios 통합 모듈","date":"December 30, 2019"}}},"pageContext":{"slug":"/etc/axios-통합-모듈/","previous":{"fields":{"slug":"/troubleshooting/auto-complete-모듈-만들며-겪은-issue/"},"frontmatter":{"title":"auto-complete 모듈 만들며 겪은 issue","category":"troubleshooting"}},"next":{"fields":{"slug":"/node.js/typescript로-node.js-서버-만들기/"},"frontmatter":{"title":"typescript로 node.js 서버 만들기","category":"node.js"}}}}}