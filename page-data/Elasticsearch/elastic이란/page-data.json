{"componentChunkName":"component---src-templates-blog-post-js","path":"/Elasticsearch/elastic이란/","result":{"data":{"site":{"siteMetadata":{"title":"Kooku's log","author":"Kooku","siteUrl":"https://kooku.netlify.com","comment":{"disqusShortName":"","utterances":"koomg9599/kooku-s-log"},"sponsor":{"buyMeACoffeeId":"kooku"}}},"markdownRemark":{"id":"c7e178ba-961e-5383-99f7-f349b22b3f81","excerpt":"프로젝트를 진행하면서 Elastic을 사용하게 되었다. \n따라서  Elastic에 관한 공부를 하면서 정리를 하고자한다.\n관한 내용은 elastic 공식 사이트를 참고하였다. 1. Elastic: Product Portfolio  Elastic은 Kibana, Elasticsearch, Logstash, Beats로 묶여있다. 이를 Elastic Stack으로 부른다.추가적으로 상용 제품인 X-Pack(보안, 알림, 모니터링, 머신러닝등의 기능)과 Elastic Cloud…","html":"<blockquote>\n<p>프로젝트를 진행하면서 Elastic을 사용하게 되었다.\n따라서  Elastic에 관한 공부를 하면서 정리를 하고자한다.\n관한 내용은 <a href=\"https://www.elastic.co\">elastic</a> 공식 사이트를 참고하였다.</p>\n</blockquote>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 330px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 43.91891891891892%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHsPZhBYv8A/8QAGRAAAwADAAAAAAAAAAAAAAAAAQIRABAS/9oACAEBAAEFAmL918Fm/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAYEAACAwAAAAAAAAAAAAAAAAAAIQEgMv/aAAgBAQAGPwJQjI6f/8QAGRAAAgMBAAAAAAAAAAAAAAAAAREAICGR/9oACAEBAAE/IQFZG5x2GWKNP//aAAwDAQACAAMAAAAQrw//xAAXEQEAAwAAAAAAAAAAAAAAAAABEBFB/9oACAEDAQE/EC9Y/8QAFhEBAQEAAAAAAAAAAAAAAAAAEQEQ/9oACAECAQE/ECLn/8QAGhABAQADAQEAAAAAAAAAAAAAAREAITEgQf/aAAgBAQABPxAReAjw7uuMQnuObAacH54//9k=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"logo\" title=\"logo\" src=\"/static/367efd6371ca73c8260244cba74028ff/80fc7/logo.jpg\" srcset=\"/static/367efd6371ca73c8260244cba74028ff/a80bd/logo.jpg 148w,\n/static/367efd6371ca73c8260244cba74028ff/1c91a/logo.jpg 295w,\n/static/367efd6371ca73c8260244cba74028ff/80fc7/logo.jpg 330w\" sizes=\"(max-width: 330px) 100vw, 330px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<h2 id=\"1-elastic-product-portfolio\" style=\"position:relative;\"><a href=\"#1-elastic-product-portfolio\" aria-label=\"1 elastic product portfolio permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Elastic: Product Portfolio</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.4054054054054%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACtUlEQVQoz32SSUzTURCHe3KJGoMmnhACiQcwaIwHTUz0Zjx4YUsMAUwEDu6iRgNY9YASUQhQlEUQ48KirVVrEYoIGCA0ylJADEIbyyIgdLeFlsLn++NCuDjJzPvNe5Pv5b0ZmdlsRq/XYzKZGBoaotdg4OvgIL39fXR2dWIcNrJki/zXFhd/F8i8Xi9TU1NYrVZ+ejzYXA6cHjeOGSs2ixWX0H5B84vieeGSdnt9OGe9S25zz+Hxzf+DyiQxLYD63i7GNR0MxOUwknSXqaI6HDfVuFJK8SSXMpdUgj+2AHfTZw5WNLDx4kNCz+USlCQnpfz1EtC/sIDM5xO32ey48GEqqaUjOBljRCqtV8owJilw7pXj2Z2Bf0cabD3LrPIjYQoNsoQC1iZeY3XkKaLzqpeBCyJ4BVSymvZ2DmXfIrqomHyVirSaZyQ+rST5uZJjIo+qqkL7pZ+Eh41EZFWxOSWTTUdSib+nWgZKYdpiwe92k9/ezKqsDEIq8pG/V5PQpCZcW8leofe0vCSo8TllfW+5o23jokrLmgQ566JPE1tQswyUPnJONEayxx0GLqg0HChUsTOnmn0KJfJ3HcRW6dijULEtu5LqnmGiynQEpFeyOTmT9TFniLurXAZKwjcvuuSfp1zXyvXyB+y6XEjwyWy2n8/nhrKOw1nlBB/PRhaTzpMPXezPVSOLz2VtXDoBUSeIzn26EigJFhdo++4gr3OM+4YxinvGqBiYRDMwyiODGUX3qNgb4YXZxZkmE5HqPo6+6ibldReln0wrn+z/M7SX+lxsqLUS8s5OoM5GYIOTq8164tvHCW92srvFTki9hVBxHibysGYXW3RObhu9/wZ8Cfh3yvstHjTf7NSPOqgb+e2NIzPozDZ0Yk8ncmmtNTvQmu28Ff5G1BumfzLxY5jJyQl+AdpWwy+RmDlDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"portfolio\"\n        title=\"portfolio\"\n        src=\"/static/e1b33bf560a693491ad61fa6a3f100e6/fcda8/portfolio.png\"\n        srcset=\"/static/e1b33bf560a693491ad61fa6a3f100e6/12f09/portfolio.png 148w,\n/static/e1b33bf560a693491ad61fa6a3f100e6/e4a3f/portfolio.png 295w,\n/static/e1b33bf560a693491ad61fa6a3f100e6/fcda8/portfolio.png 590w,\n/static/e1b33bf560a693491ad61fa6a3f100e6/efc66/portfolio.png 885w,\n/static/e1b33bf560a693491ad61fa6a3f100e6/c83ae/portfolio.png 1180w,\n/static/e1b33bf560a693491ad61fa6a3f100e6/fd8a5/portfolio.png 1659w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Elastic은 Kibana, Elasticsearch, Logstash, Beats로 묶여있다. 이를 Elastic Stack으로 부른다.추가적으로 상용 제품인 X-Pack(보안, 알림, 모니터링, 머신러닝등의 기능)과 Elastic Cloud()를 사용할 수 있다.</p>\n<p>데이터를 색인하고 분석하는 일은 Elasticsearch에서 이루어진다. 그리고 저장된 data를 시각화 하는 일을 Kibana에서 담당한다. Logstash와 Beats는 log와 data를 수집하는 역할을 한다.</p>\n<h2 id=\"2-elasticsearch\" style=\"position:relative;\"><a href=\"#2-elasticsearch\" aria-label=\"2 elasticsearch permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Elasticsearch</h2>\n<p><em>Heart of the Elastic Stack</em></p>\n<ul>\n<li>모든 데이터가 저장</li>\n<li>검색, 쿼리 실행</li>\n<li>실시간, 풀텍스트 검색</li>\n<li>많은 곳에서 데이터 저장소, 데이터 처리엔진으로 이용</li>\n<li>오픈소스</li>\n<li>Apache Lucene이라는 검색 라이브러리 사용</li>\n<li>분산시스템, scale out이 가능</li>\n</ul>\n<h3 id=\"구조\" style=\"position:relative;\"><a href=\"#%EA%B5%AC%EC%A1%B0\" aria-label=\"구조 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>구조</h3>\n<p>모든 데이터가 저장되며 검색, 필요한 쿼리들을 처리한다. 개발자들이 사용하기 편한 API를 제공하고 있다. </p>\n<p>Apache Lucene 이라는 검색 라이브러리를 사용하며 distrututed, scalable, highly available의 특징을 가지고 있다. </p>\n<p>모든 데이터들을 대용량으로 처리하기 때문에 클러스터 환경으로 동작을 한다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 455px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 110.8108108108108%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsSAAALEgHS3X78AAADqUlEQVQ4y42VXWibZRTHn83O9kZkyGRMUNGu0k7KxKLeqAhe+HXnjbgLNxBBcKCCCrsYqEzRbjLY6Ca2a7o2dmua9CNt3nx0DKxDu7TrumRts4Ym/Y5rTZM0Sbus6c/neZOUZlk7Xzic5zl5z+/5vyfve45AXtFolPHxcRKJBGNjY0xNTREIBFhYWFA/s7a2lue3ukQkEmF6eprR0VEd1NfXh9frxe12Mzwywp1UirQEbWUbDxTDw8M6YG5ujqGhoXVlt/x+PDeGWAjNPVCVwqWzUJELptNp3SvY8sqKvl5KLDMeXWIyGmN2MUwwLEsTjjEVXmQmHCawGCMg99zN5CqoyEnNyU4kk4QmJ+nx3+KlljNUNv1AqfEXdprr2Wc5SZWlmqcsZ9hlqeMFywkqLcf5yGWWhyczCjfCcipX40uUV//MqZoy/jUWY617lvKu49y0l5JqL+Ynx/u82fMtYetOEtZHect8kB+ve/MfeSN4ORnnmbpa/jbsBoPA1/AYb3QcJdnxCPwmMNle55DzC2iU6ecFh7UDfOa+vgUwGqHU1sahpg8wNb7IkXPvssdaw1n7e2jdr3BA+5z9jhM4bC/zh1ZFVdcRvunvzwdufM+S8r0st5vZ7azhNccxKhwnEa5WypyneNUla+o4LfcWaZ3SrAithe/7/9wcqBTutbfj0irhgmC88wmedJ1l1Po0NAuudldQ5LzAdlcLJa6LEmjku/4rWymMUGZv4y/bc1ArmG7bRVnPaQIde1j5VXCzu5QdzmapzsQOaUL7/cHAvRL4of0wDfZ3+Fo7SInTyJf2j6l3vM0n2qcIp4ltUuH/AiZkDZ/XTJn6uDRpXboa3Ts1Pa5g25wtFMnabgrMfT5xCdxnlzfK+hTLWql66cnSq0fN7TNAeZC9eWuFqdgSFd2y2JdaefiSmYekFWX99p7W9bWyksttiO5Gjrk3Aa5modV9vQhzHaKzAdFhQLQbMmubMbPuyJqMPW5pYGRuthCY1/PSa1z2+6j1DGDwDnJ+eIiaq1f46qKRplEv5zzXqJdxw41rBG//k98c7oXpX80mrer2xOR94wXtKw+Wtburq6SkqTIov5K6Q2Qptg7JxVdlU8nl3FfhvZfqkbOzs4RCITweDz6fj8HBQX10FIyAgn9YtvyZmRnm5+d1gBoRwWCQiYmJ9VnT29vLwMCAHlP3qG6vTOUWAFdkt1YKVIIyNSLUaFBjQoGVUrVWXkH8clQosJpJ8Xic/wCERNIRuz0C6wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"node\" title=\"node\" src=\"/static/b6a6f0ec7ba786791760349886596bfb/379c3/node.png\" srcset=\"/static/b6a6f0ec7ba786791760349886596bfb/12f09/node.png 148w,\n/static/b6a6f0ec7ba786791760349886596bfb/e4a3f/node.png 295w,\n/static/b6a6f0ec7ba786791760349886596bfb/379c3/node.png 455w\" sizes=\"(max-width: 455px) 100vw, 455px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<p>데이터는 샤드(Shard)라는 단위로 분리하여 저장한다. 그리고 Elasticsearch를 실행하는 한 프로세스를 Node라고 부른다. </p>\n<h3 id=\"클러스터링-과정\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0%EB%A7%81-%EA%B3%BC%EC%A0%95\" aria-label=\"클러스터링 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클러스터링 과정</h3>\n<ol>\n<li>노드를 여러개 실행시키면 같은 클러스터로 묶인다. </li>\n</ol>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 35.810810810810814%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7CAAAOwgEVKEqAAAABr0lEQVQoz1WRv09TURiGjwMLifwjLIbEDuCkDsbBlT+AxLgykJiwGBdNNJHBwcXECIbSEoq0IlKpSBRsaSERCGoj19YWCu2lLZS24f54+M6BxDi8ue95v+c9+XKPqrQcNqtl1uwD0naZ4kmbcssleVhj2a6yIio1T9kTrVyc9azSdskL+1XOmktX66anPu7leDTbz9DcXZ68vcH8rwhTlSpqLkhXYhr1PsiYMC8LO8ab7EOIhL3PcHZDuAk6FyJcTkSI7R+gooUsz6K3GIneIRC9z+D2OsHdPGp23IAq9obn+d88tX4abzKZhUsF7m1lxAfpiE9xKT4pvV3URMGiO/aAK+8eomZeMLC9IYM/4l/LJmHU9CtGclke7/ww3mQzo4RKfxnYXDVeb6m3Hy/Khct2jWtrqwQyKXqSiwLm+X5Uozf1iZuZJQLJBJ8Py8QrJa5+WzBZX2qRreM6o8WcmV9PL3F7/Yv82zqq6fh4Lvgi/W060Dg9zxwRPtTkQY7brvHOBacZeU9c91yO6fooTbn+P3kiX+R4nu5z1GhgWZZRs9XCk8z1PcN4/v9dfdcZBlfMq83QA3gAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"node1\" title=\"node1\" src=\"/static/bebd99144277c3714a7c367ee652ef31/fcda8/node1.png\" srcset=\"/static/bebd99144277c3714a7c367ee652ef31/12f09/node1.png 148w,\n/static/bebd99144277c3714a7c367ee652ef31/e4a3f/node1.png 295w,\n/static/bebd99144277c3714a7c367ee652ef31/fcda8/node1.png 590w,\n/static/bebd99144277c3714a7c367ee652ef31/23296/node1.png 675w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<ol start=\"2\">\n<li>샤드들은 각각의 노드들에 분배되어 저장된다.</li>\n</ol>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 29.72972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7CAAAOwgEVKEqAAAABl0lEQVQY01WQvU9TYRTGX1hICosbmwtxRokJC8ji4GYYTYgbhr+AiVkTw0KACC5o5UMhBPpBaYXyFWgoloIIIRBDNZfeAoV7b6F83N7w49wri8OTnPN7n/PkvEcZ1w7bVoENwyBlWGjFG86EbZmW16eMArmrEidXNpuG6bG0sLx49MsbqU3P89M8F4+DWj3R6Zx+RXf4JY8i72nb/03mbI+OYDPV8VHU9Fd6DjV+aAnaA8345kKURUcYO7VY2RvhTaAFFY/xID7OpH6MCud0Hkb7qIl+QE0N8PrXOrGjv1SGuqiaHUeFBnmX2ac/s40v2EXFzIT4hvmU1ejYWcYX7qXcZbFR/NohKqDnZIsxkQwHvtCylWTyKCv1ECoqG04M8PZgl04J/ce+oYJ+/NkMrTtpqYe8X6jIMJ/dQPceL1KLNCbneJyY4aN2wO6FRf3qLE1rC9QKi+RzzJ8eU5f4zjNhT+UtXTAYzP7hibCG5DzPJWMpb6IuS7fYDpREjkjuz7l969X2PSvarv5nF9K7Xud+1lVRsu4A/S5+sQFd8T0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"node2\" title=\"node2\" src=\"/static/73960bff2e52fbfa4d988b635770de4a/fcda8/node2.png\" srcset=\"/static/73960bff2e52fbfa4d988b635770de4a/12f09/node2.png 148w,\n/static/73960bff2e52fbfa4d988b635770de4a/e4a3f/node2.png 295w,\n/static/73960bff2e52fbfa4d988b635770de4a/fcda8/node2.png 590w,\n/static/73960bff2e52fbfa4d988b635770de4a/1b747/node2.png 679w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<ol start=\"3\">\n<li>무결성과 가용성을 위해 샤드의 복사본을 만든다. 같은 내용의 복제본과 샤드는 서로 다른 노드에 저장된다. 리플리카 라고 하는 복제본의 개수는 유동적으로 조절 가능하며, 복제본을 0~* 개 저장가능하다. </li>\n</ol>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 28.37837837837838%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7CAAAOwgEVKEqAAAABsklEQVQY0x2Ry2sTURjFr0vBRX2BT6xaEHGrf4IggguRbsStG5eCK8WdO8VAtSrFRZUQGy3atJlmkrHpTJJqLEoMVq0NsWgtaWfy6DyamUT782YWB+7v3O8cPu4VRcskZ9bQzXW+2S4bwRafGnUM0yRrWnxobITe11ZLzqyhWxY5q0HD/0fVcdHXa5LrFKRWvAAxlLzA/cQ5IsYNRn+k+d7u8kQdZDh/iyvvo/TNTlLtwvPcdSKZq9z8GEOocYpel6nyY+4lLzJUjnF3/gHTq4uIw6lhjqmP2Kc+5fy8xmfb5mRmhH5tlF1anB0zEyx4HmfzY+xXRziSfYWYfoHRbHKtpLFbecgJfZy+9DMiy7JQpMYR6TeI5Bin5jQWnBbbtAQi1QvG2f72NYuuzUBBQygv5XbSV2IUmiaXSkWZi8u87JiMcqcqC4/nFPoNhT3ZBJfLRczA5/S7DAf1KQ5InSnOUO8EDJbm2Dub4KicP2QkqXgut5e+sDM7wUA+Fd5FV38jlj2fitNmydlkTb6f09liZTMIuac/8tzzau1OyBWpXzJjy4+y/L8hV9w2P12fuuT/0/125rFB+b4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"node3\" title=\"node3\" src=\"/static/ea330622e104c3b00d3e73cbbfb21b22/fcda8/node3.png\" srcset=\"/static/ea330622e104c3b00d3e73cbbfb21b22/12f09/node3.png 148w,\n/static/ea330622e104c3b00d3e73cbbfb21b22/e4a3f/node3.png 295w,\n/static/ea330622e104c3b00d3e73cbbfb21b22/fcda8/node3.png 590w,\n/static/ea330622e104c3b00d3e73cbbfb21b22/74866/node3.png 668w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<ol start=\"4\">\n<li>시스템 다운이나 네트워크 단절 등으로 3번 node가 유실되면 0번과 4번 샤드가 하나씩 밖에 없기 떄문에 자신이 아닌 다른 노드로 복제본을 만든다.</li>\n</ol>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 27.7027027027027%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7CAAAOwgEVKEqAAAABoklEQVQY0zWRQU8TYRCGv7sGT0aNaNSEo4kHf4F6M/Fq4sl4MVFj8OrFM+GEEjQSjxQVWso2QGm3dYFCY0RSlBKjGCzEdrdsd7tbt9juto9fl3h48uadzDuZyYjcgYGql0nrFT5bdZxWly+WFXrVqJIyTIxmm0ozoOAGbErW6wElL6B26JOr6rLPIC35ZNmIF3O3GJ29xpj2kFdbUb63IbLymJH0PYYLE4jkexbNCqUWJM2/5O0WT0pdpmzYdnTGlOuM5Id4XRjn+WYEcS75kouS/tQbruQUtj2PG7l3nE6Oc0mbRsy/JarvoTowuBvwbL/D3Z8dJmqgmWXOLoxyIRPhfGaSyyszCLEYQ6TiiIVp+j4k+OG5DKyq0k/JehQxNxkOTMiNbu90ub8Ld3aOBmYOyvKCXj4W9h/PKoj+ZYWT2ix92RmuflRx/DY3N5Y5lolxZikhNc6qbZD/A49+dXm6Dw+kzsuNiw2LU1ovr3AiGw/zYsNukK85rEmKjod52OGb2wx9r75uNdCbPr89ny3Xp+ge6Z70Vfmo//keX+se/wCP+4BYGjDT9AAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"node4\" title=\"node4\" src=\"/static/5e545dff921000d3cb73771ef468d750/fcda8/node4.png\" srcset=\"/static/5e545dff921000d3cb73771ef468d750/12f09/node4.png 148w,\n/static/5e545dff921000d3cb73771ef468d750/e4a3f/node4.png 295w,\n/static/5e545dff921000d3cb73771ef468d750/fcda8/node4.png 590w,\n/static/5e545dff921000d3cb73771ef468d750/99272/node4.png 669w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 27.7027027027027%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABt0lEQVQY0y2Rz2sTcRDF9ybowUMPgnoqKCheRPDgXyD2pl4ETyIe2ksvggS8KtJcPFQtFe3BotDY/CCEuBvT5heGtGhjAs2utTZYmybpbjbJbn7sbvj4bfXwGGbezDBvnlQ2uxQaTTJ7+2w0dOrtHuWmQVrk+f0GJaONPvCo9TxUy0WzPLSuy0Hfo95z2GiZrLfaAiZVe4Dk//SAF6Hr+JPTzJaWUQcjPuR8PA1NMBO7x7PMK7atA4o2rJgOcX3IZNXj2xAyv1NMh2/ztrTAk7U5AjtfkC7Is1yM+zkvv+RqLkjRspjIvmM8NsOl2HPORudJ1XZY/DPgodbh8VaXuxUbxYTIVhaf4uNK+j2nlQWmyjkkKRFEkgXiSxxPhtm02oznFJEHkJQQUnSRjF5jvg63NIf7P13uqH0SusfrSoFr8pyYDxz13Szmkc5lo4ytBDmZXOZyXsZwhtz4muLE5wCnVkOMrYZR7RYRcdFUdcSj3dFR1ITkN3vbYtlHzqQjHEssCQVFpJJpsSYef4jNjo3RH/Gj06Pwv/Zd8M2+y67tCt6lIgxRu44wxKVmH5rSYd34h1/WgL8gmIKV9iaszgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"cluster\" title=\"cluster\" src=\"/static/ef75146dd9dc925d26631c0764d2efd2/fcda8/cluster.png\" srcset=\"/static/ef75146dd9dc925d26631c0764d2efd2/12f09/cluster.png 148w,\n/static/ef75146dd9dc925d26631c0764d2efd2/e4a3f/cluster.png 295w,\n/static/ef75146dd9dc925d26631c0764d2efd2/fcda8/cluster.png 590w,\n/static/ef75146dd9dc925d26631c0764d2efd2/efc66/cluster.png 885w,\n/static/ef75146dd9dc925d26631c0764d2efd2/c83ae/cluster.png 1180w,\n/static/ef75146dd9dc925d26631c0764d2efd2/16068/cluster.png 1451w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<blockquote>\n<p>따라서 노드의 수가 줄어들어도 샤드의 수는 변함 없이 <em>무결성</em> 을 유지한다.</p>\n</blockquote>\n<h3 id=\"검색-과정\" style=\"position:relative;\"><a href=\"#%EA%B2%80%EC%83%89-%EA%B3%BC%EC%A0%95\" aria-label=\"검색 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>검색 과정</h3>\n<p>처음 쿼리 수행 명령을 받은 노드는 모든 샤드에게 쿼리를 전달한다. </p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 39.189189189189186%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7CAAAOwgEVKEqAAAABwUlEQVQoz32RTWsTURSGL7hxI7gWQRDUhTttEf+AQqGQP+DKjb/AhRbcFBfdlFa60bTgVy1VokkaEoyhgWQ0oY5SUbtQOyYxxWYyrTFpJp2P+3gzSYy68MDDOefl8nLOPaLWdnhtmbw0a2h1k68tmx3bY82qK20bzTQpKc2yXd6od68sC01hNNv86PhK99jp9KirWiSrm8yvXGQyHmIuf51oWWd9t8xUbJzZlTGm8hPEKzofGltcjYxxpzjNpHaLpc0svZAMQkqJuFspcSQ6y9FUmMOx21x5XyS1VVL1HMeehzmUCHNZz1H49oWJ9A3OZBc5mHzApfV8YOIpE1/2TF1fGYbLJURiWfEY8fQeoWKWWNlARO4jni0ilhcIreXIbVc5mVngQPoJIv6QC/rQUPYNva7haq3O+WKGs8kIp6OPmN54x0f1lyP5FKOFNCe0FDOVzxj2Hse1F4wUMpxS2k1jIzAZTPd7wqYr2VPN945NQ+Vu3XSg5Uh+7vs0FS1FQ2ErrTnQVL3bGR5kgJCOh/vJpL2k42gGXsMO1uiOH+T/4P9DcBRpO3jXEuyfm8Edn0e+rdLfpX/B4UrD/k/t7/gFzqItzq30ZcoAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"search1\" title=\"search1\" src=\"/static/c64389f5591da9a0b346baa1da54b416/fcda8/search1.png\" srcset=\"/static/c64389f5591da9a0b346baa1da54b416/12f09/search1.png 148w,\n/static/c64389f5591da9a0b346baa1da54b416/e4a3f/search1.png 295w,\n/static/c64389f5591da9a0b346baa1da54b416/fcda8/search1.png 590w,\n/static/c64389f5591da9a0b346baa1da54b416/d67fd/search1.png 670w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<p>1차적으로 모든 샤드 검색을 실행한다. 각 샤드들은 요청된 크기만큼 검색 결과 큐를 노드로 리턴한다. 리턴된 결과는 루씬 doc id 와 랭킹 점수만 가지고 있다. </p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 39.189189189189186%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABsklEQVQoz5WRTU9TQRSGZ4M7EhJ/gok7WLszaGxcuGGFLvwHJvoPjEYWLjCNCxNZkCpUWbAotFqgH1CIWOTjIgYNhKg1lhq5vS20pdyveZw7LRK7803enDPPzJycOSMOmi7ZUoH4zz2mi9/YqFSwTjzmf7XYVMAsS7Ns6Tvx/QLT+z80q9o+ZcWtts2mh1izTMLJQR7HQjxfvMvoToqtWpUnyZsMx64Rzt3jxW6Kz/VDHiUGCL8fYmRzhKfbU5zwr3wpETmzzPmZMbqVz72J0P8hg3FUoSf9mu5UlC7FL6+kWS//Zij/jL6FKGJugkv5OdR9ZakLBXJ8XdBEzEwg4uOIWIS+5VmMqmKJ6F/Wu/QWo2JyIfsSMftK7Y1z8V2STrlBwd2jBre2VgilE1zJJHiw84lSrcagscz1tUX6V3M8/PqFA9vmhpEntL7EVcXu723rDm3PV5a6WMP1EU1X6lmUpUtdRVu54SjmwrHaO9a5pO74OAFzWsxW+aHtqY9p+TQXutePRZrhDF4kD8Vqq//2XNqLjtiZn0lI1aY3uYl9ewznziT+akEfleoJwcD/138AL5Muf2/HPyEAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"search\" title=\"search\" src=\"/static/f028da47f64cec8e94297413912f7278/fcda8/search.png\" srcset=\"/static/f028da47f64cec8e94297413912f7278/12f09/search.png 148w,\n/static/f028da47f64cec8e94297413912f7278/e4a3f/search.png 295w,\n/static/f028da47f64cec8e94297413912f7278/fcda8/search.png 590w,\n/static/f028da47f64cec8e94297413912f7278/efc66/search.png 885w,\n/static/f028da47f64cec8e94297413912f7278/c83ae/search.png 1180w,\n/static/f028da47f64cec8e94297413912f7278/f470a/search.png 1443w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<p>노드는 리턴된 결과들의 랭킹 점수를 기반으로 정렬한 뒤 유효한 샤드들에게 최종 결과들을 다시 요청한다. </p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 39.86486486486486%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7CAAAOwgEVKEqAAAABwElEQVQoz22RTWsTURSGR0Tcdicu/BHuRenChRHEP+FKcC0oIhgXAaEgXSikaGrAD1ptbGlrlWSSBtv62VZogh/NhyZNbzPRYNJMpnPn6Z07CQ3igYc5895733PuuUa13WVJVElvV0iLGuVWB7HbJav+Mz5im4ras9XuBJoQLO4Ipdn8sSVWx6VhB9RVbiTKeaIvhwlPX+Ru9gZzWxss19aITJ1lZOYCkbdhVWgT8+cSV6dCxNbHuLk8SqqWIwhJP1qOxLhfKjCUuMexhXGOJqJc+7rOk2qBI7NRjr+Jc3g2Rvh7jmRplStmhBPmcw7NxRkp5rWJIyXS83T+1zccLRYwZh5jTCtexLi88ZmH5R8qH1f6U4zJB1zPfyFeyjE0H8V4NaGu9YjbmweGXs9Qd2juWIQ+ZAhlFjidnmfiV5HVRp3hdynOfVzklPomG4Lsb4uTKybnP2U5894kaQlt4iqzvmGzq2a4q0bQJcBRtHXrHmoNe09pe35lT+P+o1n2wYP4edPv0Os4OKlv2HdSOJNruPWWHrOrruJX95E93AFkr7NB/NCGcmwF59Iz3Fuv8SrN4Mn0hj79+J82sKrO7AND/jDUIVpr5AAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"search2\" title=\"search2\" src=\"/static/a733e61debb145efecf36a2a97be125a/fcda8/search2.png\" srcset=\"/static/a733e61debb145efecf36a2a97be125a/12f09/search2.png 148w,\n/static/a733e61debb145efecf36a2a97be125a/e4a3f/search2.png 295w,\n/static/a733e61debb145efecf36a2a97be125a/fcda8/search2.png 590w,\n/static/a733e61debb145efecf36a2a97be125a/74866/search2.png 668w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<p>그 후 전체 문서 내용등의 정보가 리턴되어 클라이언트로 전달된다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 39.86486486486486%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7CAAAOwgEVKEqAAAABx0lEQVQoz22RTU9TQRSGJ2Hhzo2JG36IWxNjIixk4S9w6441iYlNTXRrjBiCjUIVifhRarUEUO6lNU0Bq6lBME0q3ktpb6VULLa9X48z7b2xC8/Mm5l55+SZkzOi9scmV6+gVU0064DvrTZ16WWtffSaiW5VMU86HJy0yfbOFut1i4r0jjoehx2XRqCfbRexXClzPzVCdHGMe9kJXplFtqxtIolRJqV/IxMlUy/xzshzPTHC1OcYkdxd1q1d+uETRrMrgU9MgzOpac4uzXAqGWN8p0CiZjD05gHDK3FE6iHR0jarRpFx7TbD718wlH7Mnb1vPYjjeXi+/w84K4Ei9RSRnEO8fMTVLxs829+T+xnE63nEQoyJnSLxH7ucTk8jlhYQi7PcKvcrdHwPPwD+UsD8YZMrnz4wupzkgpZm3ijztdng0obG5UKG85saqw2LnPTO5XXGClkubunojXoP4kpYCFR9FLKPOKpc18GWa1vqt+3jSN+WF2ptybOSF3pO31OAo0Bqf2x7CL/r4KyVaEXe0o1v4laP8dTLsjfqdSUvkDugXt/UDCoMqxS+7eLNfcS59hz35gq+0ez/XZg48Iv+wPhfqPy/VJIxg4DD7FgAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"search3\" title=\"search3\" src=\"/static/10b13002c9885c940f2709d49e5b950d/fcda8/search3.png\" srcset=\"/static/10b13002c9885c940f2709d49e5b950d/12f09/search3.png 148w,\n/static/10b13002c9885c940f2709d49e5b950d/e4a3f/search3.png 295w,\n/static/10b13002c9885c940f2709d49e5b950d/fcda8/search3.png 590w,\n/static/10b13002c9885c940f2709d49e5b950d/d0e73/search3.png 671w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<blockquote>\n<p>따라서 데이터 입력과 검색이 서로 다른 노드에서 실행되어도 상관없이 항상 샤드 레벨로 분배되어 검색한다. ex) 데이터가 1번 노드에 있는데 3번 노드로 검색해도 3번이 1번의 documnet를 가져와서 리턴할 수 있다.</p>\n</blockquote>\n<h3 id=\"elasticsearch-is\" style=\"position:relative;\"><a href=\"#elasticsearch-is\" aria-label=\"elasticsearch is permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Elasticsearch is…</h3>\n<p>Elasticsearch는 <strong>document-oriented</strong> 검색엔진으로 기본적으로 JSON을 사용한다.</p>\n<p>REST API를 제공하는데 port, index, type, documnet id를 한 uri로 표현한다. </p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 35.13513513513513%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABJ0AAASdAHeZh94AAABHklEQVQoz3VR2YrCQBCc//+XFQQfghBEzZ2Y+zIJBJIXUZJFfFswtd2zBtZdHSi6p2ZS1TUReKzpfME0DD+bYQRuN2AcZT+dz9R/4n654Kvrcb9e8W6Jtm2RlyViy0IcBMjyHIllEyz42y1cgr/bIdhsUPo+uq5D3/f/wPzpdIJI0xSmacLxPFgkwr1BVTMMaLoueY+EGEEYIoqilwhomOPxCFHXNT4WCxgkoCgKlssltP1e7i0Sz8gwyzIJNn+HJEnQNA1EVVVYrVZwHAfr9Rpbing4HKRbURRPH82is8FvkziOwcMJJlVVlYI6ReQDnyNSVK4cJaSoDOa4/j1/Eizph/C7eY83nKtt29LEdV05MfPzPea55zt8zkPNgt+m2ekmgZO1ugAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"restapi\" title=\"restapi\" src=\"/static/d0aef0ef355532175616e3097b5c430d/fcda8/restapi.png\" srcset=\"/static/d0aef0ef355532175616e3097b5c430d/12f09/restapi.png 148w,\n/static/d0aef0ef355532175616e3097b5c430d/e4a3f/restapi.png 295w,\n/static/d0aef0ef355532175616e3097b5c430d/fcda8/restapi.png 590w,\n/static/d0aef0ef355532175616e3097b5c430d/efc66/restapi.png 885w,\n/static/d0aef0ef355532175616e3097b5c430d/c83ae/restapi.png 1180w,\n/static/d0aef0ef355532175616e3097b5c430d/0d390/restapi.png 1472w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<p><strong>full text search engin</strong>이라는 특징을 가지고 있는데, 데이터를 저장할 때 처리의 과정을 거치게 된다. data를 검색이 가능한 형태로 가공을 해서 역색인 구조로 저장을 한다. </p>\n<p><strong>real-time search and analysis</strong>이 가능하며 데이터가 저장될 때마다 index구조로 만들기 때문에 실시간으로 검색이나 쿼리가 가능하다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 54.72972972972974%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAACmklEQVQoz02S2WoUQRSG5xF8CMEbX8FL38IbVxAiBtyjooEERUhQjEEScYlrwCgm7oIZvVDJOGp0kpj0GGIy09PV08v0LD29zmd1x+1A0XX+Oufvv079GXfqLaKs0mg2aTQatFotLMuiXq/TlFiSJ/sEs20b13Wp1WoYhoFlWFR1gW3Z6PKrKAqZ6YVR9KqgVCqlRWtrayShCYGmaWnuOE6Kue02xWIxrUtCtUosVgpUW1V8PyAMQzJH51ZQNcFcocDi0hKzs7NpcblcpiCxXC6HkORJtCVhNptFKSppPi/myKt5FLFALM+SyPTk16jYBk5rXUWqxFs/jOL4LxbHHf6Pjky9oI1aVwmjMB1PR4KZI/kKWeUNJ58cJPTXiRzHJgwCeUUPq+7+oaAdhP8YIx+MYrr1w5iKrhMlVz7ySWNmNUfX5C6efp3ADT18tyX7Y5q+z/GHMwxlFzj3fJb94zl6p75wavITfc/z9E+8kmLU9Geu7ImiiEx3boVas4HdslAdDcd1iKX0ZJmmz3vF4aNiMrNk8G7BYrogeDJf5e03h+x3h8+LNqoIMJyYIJSE+z78oFzR6EQdAi9IrZMsXyr98LrCzmsmh+9YHByz2H7V5tJwg8FbBlfGKvQM6Gy7brLpXon7zywMaa9M98wyopo8uy9n5v72X4swDnj5SHC4z2DLrRq7Rgx2XzTp6tMZGljh6s1l9g6U2DipsmPc4GvBRkh7ZXa//5naJn0EadrEcw05gkj6ami8xrEzBgdum2x+ZrJnUKe3v8TZE6tsvbbKhhcaxx9LopU6q9LkZUMSvprPUnNq0hZxakzP8/B8jziIGH5gcX7E5O6YzqFRgwsjgtOXdUYvVei+IRh+aqJKMlX2l6oOwm7wCzWaEpQGcrPlAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"realtime\" title=\"realtime\" src=\"/static/af64cb8d014c43c235f33b299deb3ac2/fcda8/realtime.png\" srcset=\"/static/af64cb8d014c43c235f33b299deb3ac2/12f09/realtime.png 148w,\n/static/af64cb8d014c43c235f33b299deb3ac2/e4a3f/realtime.png 295w,\n/static/af64cb8d014c43c235f33b299deb3ac2/fcda8/realtime.png 590w,\n/static/af64cb8d014c43c235f33b299deb3ac2/efc66/realtime.png 885w,\n/static/af64cb8d014c43c235f33b299deb3ac2/db3a5/realtime.png 1087w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<p><strong>Aggregation</strong> 분석기능도 제공하여 저장하고 있는 데이터에 대하여 통계를 내는게 가능하다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 49.32432432432432%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABJ0AAASdAHeZh94AAACUUlEQVQoz12SS0tUYRzG5wP0IfoABS0iqL2rCBKhVRcLSkzIWoRJ0kUoozK0RVYbF7apNtE6CcvRwEYszWHmMHPm4plzv86cuR1nfr3jhCO98PKu/s/7e57/E6vX60TNJohb2VGw8gVc8brpNB/fvGbh5SzxT++xCwr2joaj6PiKSmRZBJqJnVNolct0TrvdJqZpGhXPA3GdzU2UjV84qRTZxS/0Hz/Cub5TPL/ZTyGTQVN1TN0gcF2ieg3VMNj+/YfIcbqCrRYxDhwzLZGMr2Akk+RXVpm+N8aHt7MszL3AEB/7ro1rGdTCKs2oiR24lIpFItfb14h54jdb/NCxbWWzpASJYZrsxOPMTQwzNTLA/NQYRdVAt4RASaFaDUVCTXTHI5PaZNf39+xWgoCYIwQtWSYSOdgiP0mSsAyT/NIiM4MnmL5wlKdXTxO6Di2Rd7NWYTdq7NG4vs3W2jsahRwtQVkNwwOWBZW5tUVKCBqqivxtmUcPnjA5McnM1GMxHFCuNSlX61RrNeoiQ6cSkM4VaCilnuUOaru7IgyxDCmTxVQV5JUEZ+//4EzfAK8uHiMn55AVg5KmUxVuOnOaabO9/lVY9npL2RNst7uQYihfKOIYGrnVBMODVxg5eYj5S4ehEXQRWtE+TVDx2Eh8puFYvdocJOwIpgShrmvIS9+5fX2UoctDjN8aR3N8nLCBF9axRe6OqFnJ85FEPyPP+0/wH6EnyiwnfmJLaZTlVW6cH+POtbs8HH2GmpTQRQv8YoFQVCXI5/FyRUpr6+xaPcK/f6XIMmH8XvIAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"aggregation\" title=\"aggregation\" src=\"/static/6a5b32cc6939579d59e81ecf3bfa2cf1/fcda8/aggregation.png\" srcset=\"/static/6a5b32cc6939579d59e81ecf3bfa2cf1/12f09/aggregation.png 148w,\n/static/6a5b32cc6939579d59e81ecf3bfa2cf1/e4a3f/aggregation.png 295w,\n/static/6a5b32cc6939579d59e81ecf3bfa2cf1/fcda8/aggregation.png 590w,\n/static/6a5b32cc6939579d59e81ecf3bfa2cf1/efc66/aggregation.png 885w,\n/static/6a5b32cc6939579d59e81ecf3bfa2cf1/c83ae/aggregation.png 1180w,\n/static/6a5b32cc6939579d59e81ecf3bfa2cf1/c211c/aggregation.png 1502w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<blockquote>\n<p>node name, cluster name을 변경하고 싶으면 elasticsearch -> config -> elasticsearch.yml에가서 # 지우고 원하는 걸로 바꾸면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\">#elasticsearch/config/elasticsearch.yml</span>\n\n<span class=\"token punctuation\">..</span>.\n<span class=\"token comment\"># ---------------------------------- Cluster -----------------------------------</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># Use a descriptive name for your cluster:</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\">#cluster.name: my-application</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># ------------------------------------ Node ------------------------------------</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># Use a descriptive name for the node:</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\">#node.name: node-1</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># Add custom attributes to the node:</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\">#node.attr.rack: r1</span>\n<span class=\"token punctuation\">..</span>.</code></pre></div>\n<p>두 노드의 cluster name을 똑같이 해버리면 하나는 master가 되고 하나는 master에 join이 된다.</p>\n<p>같은 호스트에서는 그냥 바인딩 되고, join된 것은 포트번호가 9200이 아니고 9201이 된다.</p>\n</blockquote>\n<h3 id=\"query-rest-api\" style=\"position:relative;\"><a href=\"#query-rest-api\" aria-label=\"query rest api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Query (rest API)</h3>\n<blockquote>\n<p>query 실행은 Kibana의 Dev Tools에서 하였다. 따라서 Elasticsearch와 Kibana를 순서대로 실행 시킨 후 Kibana의 Dev Tools에서 테스트해보면 된다.</p>\n</blockquote>\n<ol>\n<li>\n<p><strong>library 인덱스 생성</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">PUT library\n<span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"settings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token property\">\"number_of_shards\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n       <span class=\"token property\">\"number_of_replicas\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p><strong>Bulk 색인</strong></p>\n<p>대량의 document를 한꺼번에 색인 할 떄는 반드시 bulk API를 사용</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">POST library/books/_bulk\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"The quick brow fox\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"colors\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"red\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"green\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"The quick brow fox jumps over the lazy dog\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"colors\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"yellow\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"The quick brow fox jumps over the quick dog\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"colors\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"red\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token number\">4</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"brow fox brown dog\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"colors\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"black\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"yellow\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"red\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"index\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token number\">5</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"Lazy dog\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"colors\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"red\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"green\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p><strong>검색</strong></p>\n<p>3.1 인덱스 전체 검색</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET library/_search</code></pre></div>\n<p>3.2 match : title에 fox가 들어간 document 검색</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET library/_search\n<span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n           <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"fox\"</span>\n       <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>title에 quick과 dog가 들어간 document 검색 (기본적으로 띄워쓰기는 OR를 의미)</p>\n<p>math가 많을 수록 score가 더 높다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET library/_search\n<span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n           <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"quick fox\"</span>\n       <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>3.3 match<em>phase : “quck dog‘“는 한 문장이 들어간 걸 찾고 싶을땐 match가 아니라 match</em>phrase를 사용</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET library/_search\n<span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token property\">\"match_phase\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n           <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"quick fox\"</span>\n       <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ol>\n<blockquote>\n<p>검색 결과에 “relevance” 알고리즘을 이용한 랭킹 적용(_score)</p>\n<ul>\n<li>term frequency는 title 필드에서 quick이 몇 번이 나왔는지 보는 것</li>\n<li>invert document frequency는 전체 문서에서 quick이 몇 번이 나왔는지 보는 것</li>\n</ul>\n<p>자세한 내용은 Learn > Docs > Elasticsearch > The Definitive Guide > Getting Started > Sorting and Relevance를 참조 <a href=\"http://www.elastic.co/guide/en/elasticsearch/guide/current/relevance-intro.html\">링크</a></p>\n</blockquote>\n<ol start=\"4\">\n<li>\n<p><strong>복합 쿼리</strong> - bool 쿼리를 이용한 서브쿼리 조합</p>\n<p>4.1 must (AND 조건): “quick” 와 “lazy dog” 가 포함된 모든 문서 검색 </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET /library/_search\n<span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token property\">\"bool\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n           <span class=\"token property\">\"must\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n               <span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                       <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"quick\"</span>\n                   <span class=\"token punctuation\">}</span>\n               <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n               <span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"match_phrase\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                       <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                           <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"lazy dog\"</span>\n                       <span class=\"token punctuation\">}</span>\n                   <span class=\"token punctuation\">}</span>\n               <span class=\"token punctuation\">}</span>\n           <span class=\"token punctuation\">]</span>\n       <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>4.2 must_not : 둘 다 포함하지 않는 것</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET /library/_search\n<span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token property\">\"bool\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n           <span class=\"token property\">\"should\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n               <span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"match_phrase\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                       <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"quick dog\"</span>\n                   <span class=\"token punctuation\">}</span>\n               <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n               <span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"match_phrase\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                       <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                           <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"lazy dog\"</span><span class=\"token punctuation\">,</span>\n                           <span class=\"token property\">\"boost\"</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span>\n                       <span class=\"token punctuation\">}</span>\n                   <span class=\"token punctuation\">}</span>\n               <span class=\"token punctuation\">}</span>\n           <span class=\"token punctuation\">]</span>\n       <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>4.3 should : OR 이랑 거의 비슷한데 없어도 되지만 매칭되는 경우 더 높은 스코어를 부여한다. boost라는 것은 (default 1) “lazy dog”가 있는 문서가 “quick dog” 문서보다 점수를 3배 더 준다는 뜻이다. 가중치를 조절하여 사용한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET /library/_search\n<span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token property\">\"bool\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n           <span class=\"token property\">\"should\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n               <span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"match_phrase\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                       <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"quick dog\"</span>\n                   <span class=\"token punctuation\">}</span>\n               <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n               <span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"match_phrase\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                       <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                           <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"lazy dog\"</span><span class=\"token punctuation\">,</span>\n                           <span class=\"token property\">\"boost\"</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span>\n                       <span class=\"token punctuation\">}</span>\n                   <span class=\"token punctuation\">}</span>\n               <span class=\"token punctuation\">}</span>\n           <span class=\"token punctuation\">]</span>\n       <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>4.3.2 must + should : must 부터 따진다. 즉, “dog”는 무조껀 포함해야 하고,  “lazy”는 매칭될 필요는 없지만 캐칭될 경우 조금 더 boost가 생긴다. 즉, 정확도가 좀더 올라간다. 즉 “lazy”가 포함된 건 더 높은 점수를 받는다. </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET /labrary/_search\n<span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token property\">\"bool\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n           <span class=\"token property\">\"should\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n               <span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                       <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"lazy\"</span>\n                   <span class=\"token punctuation\">}</span>\n               <span class=\"token punctuation\">}</span>\n           <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n           <span class=\"token property\">\"must\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n               <span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                       <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dog\"</span>\n                   <span class=\"token punctuation\">}</span>\n               <span class=\"token punctuation\">}</span>\n           <span class=\"token punctuation\">]</span>\n       <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p><strong>highlight</strong> : 검색어와 매칭된 부분을 정확히 볼 수 있게 하이라이트 표시가능, 검색결과 값이 크고 여러개 필드를 사용하는 경우 유용하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET /library/_search\n<span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token property\">\"bool\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n           <span class=\"token property\">\"should\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n               <span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"match_phrase\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                       <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"quick dog\"</span><span class=\"token punctuation\">,</span>\n                       <span class=\"token property\">\"boost\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span>\n                   <span class=\"token punctuation\">}</span>\n               <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n               <span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"match_phrase\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                       <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                           <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"lazy dog\"</span><span class=\"token punctuation\">,</span>\n                           <span class=\"token property\">\"boost\"</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span>\n                       <span class=\"token punctuation\">}</span>\n                   <span class=\"token punctuation\">}</span>\n               <span class=\"token punctuation\">}</span>\n           <span class=\"token punctuation\">]</span>\n       <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n   <span class=\"token property\">\"highlight\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token property\">\"fields\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n           <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span>\n       <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 59.45945945945946%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABJ0AAASdAHeZh94AAABUUlEQVQoz61TXW+DMAzk//+zPe5lqmihQFH5bAmEJHzf7NBWa/fCqlk6OTmji+0TzrIs6PseUhuIVqEfBlRNAyEluMZxz1vCmefZHsKswDHNcakr+EmMRq+CW3B/lPEQ9JMMQZYhzStkaYssUZimeVNXPydwJiu4ILlWcOMEF9EgyUsU19qOXckGUinUrbyhRaNWcE0Z/dzhdOuwki1CEqqlQl4KmMFAdx1aY2A4a0XQluto54p4FtWd+T0yH3TX4/NwQHA+YxxH/CWeRmZBxkQiVzKkrAXmZd5syCscVmXBixAYZyLXJ/FuOJp20dFe/HOKj50L9xQjK3JrCJvRkAlsBufHXa73OwSZw5yiHTtZXqAoSyRpCi8M4Z8ieFEENzjiGJ+wDwM6B5bn+yEKbW1PHH/nEf/le9j5PmLSsCNP02i7/I9wBvrVFI3yrgmv+AYjW6eFcihxAAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"highlight result\" title=\"highlight result\" src=\"/static/80aee1b324f20c7d777b409ebef3ad39/fcda8/highlight_result.png\" srcset=\"/static/80aee1b324f20c7d777b409ebef3ad39/12f09/highlight_result.png 148w,\n/static/80aee1b324f20c7d777b409ebef3ad39/e4a3f/highlight_result.png 295w,\n/static/80aee1b324f20c7d777b409ebef3ad39/fcda8/highlight_result.png 590w,\n/static/80aee1b324f20c7d777b409ebef3ad39/914ae/highlight_result.png 860w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<p>다음과 같이 “quick” 과 “dog” 를 강조한다.</p>\n</li>\n<li>\n<p><strong>filter</strong> : 검색 결과의 sub-set 도출 score를 계산하지 않고 캐싱되어 쿼리보다 대부분 빠르다.</p>\n<p>6.1 (bool) must + filter 사용</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET /library/_search\n<span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"query\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token property\">\"bool\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n           <span class=\"token property\">\"must\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n               <span class=\"token punctuation\">{</span>\n                 <span class=\"token property\">\"match\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dog\"</span>\n                 <span class=\"token punctuation\">}</span>\n               <span class=\"token punctuation\">}</span>\n           <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n           <span class=\"token property\">\"filter\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n               <span class=\"token property\">\"range\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                   <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                       <span class=\"token property\">\"gte\"</span><span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span>\n                       <span class=\"token property\">\"lte\"</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span>\n                   <span class=\"token punctuation\">}</span>\n               <span class=\"token punctuation\">}</span>\n           <span class=\"token punctuation\">}</span>\n       <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>range 필터를 줘서 price 필드가 5보다 크거나 같고 10보다 작거나 같은 경우를 찾는다. </p>\n<p>즉, 필터는 한번 검색 결과에 대하여 subset만 도출하는 것!!!! 그래서 쿼리보다 속도가 빠르다. </p>\n<ol start=\"6\">\n<li>2 스코어가 필요없는 경우</li>\n</ol>\n<p>  score가 필요없는 경우는 filter만 사용하면 더 빠르게 검색 가능하다.</p>\n</li>\n<li>\n<p><strong>분석</strong> - Analysis</p>\n<p>7.1 Tokenizer 를 통해 문장을 검색어 텀(term)으로 쪼갬</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET library/_analyze\n<span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"tokenizer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"standard\"</span><span class=\"token punctuation\">,</span>\n   <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Brown fox brown dog\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>7.2 Filter(토큰필터) 를 통해 쪼개진 텀들을 가공, lowercase - 소문자로 변경, unique는 중복 term을 제거한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET library/_analyze\n<span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"tokenizer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"standard\"</span><span class=\"token punctuation\">,</span>\n   <span class=\"token property\">\"filter\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n       <span class=\"token string\">\"lowercase\"</span><span class=\"token punctuation\">,</span>\n       <span class=\"token string\">\"unique\"</span>\n   <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n   <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Brown brown brown fox brown dog\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>다음은 lowercase를 적용안한 경우</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 489px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 166.2162162162162%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAhCAIAAABWXBxEAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC9UlEQVQ4y51V2XbaMBDl/7+op489fUiTlJACJjbeZUmWZSzvxpYEHci+GGgHo6MDczWjmXvHEyHEfr/f7Xb7Z3u7P20TJSVOs7mHTETTvCzyQir1eMTZUybwrduOMN5LBb5SSq31pZHhePAe+p6JwqYJzXLA44R5FHsEKy3PgMGU1g5h9y4iGxEl6SqIDB+lQgR+po63OAlWyopiC8dmRGduaGEmqjrPtl2jTtziCSyl8mgy9xFJs7ysLBR5Mb5eGFNzxcRo8Ne0VyGeOgFUnqSQOVs7jGUbukmrtoGOjID1bhiGsiw3ZZ0WlagbWCFUWfRav2v+Zzu0qu/7lPN/osdTZIxjhIjj+kvbu7fc5dpHCK9se2FZd4YRRpjQGGNKcPz5mTCWJknKGL+ar75dz2ams7Tcn3d/vv+6vl3MDcMnlLGEgxv4HJwPm6d18nIlL+ZAElgXAV4TnpV1V6syG/bjd5lAVeCBVrmUG4iEySbOhIkilvHZyl2sHVGV4PB1wV5I8oDI7dpnWb4pyoBSO8R2FBi+m+YC2jEijN0ekF3XRWmGUwEMh7Xr+66RF6lqu93Gcfz5v0fNnDjiAJaDBJLU3bZs2qrtQM9V09Rte0ISH4WxjuiN5QUxz8vaxWTpelUNn6Hr5HkwwEBSiG9WiJpRHHHRNn0UlNmmuSRyDKpcYwqPiUheFaZNPEQGNbwl+RdgDWAc31h+mhdN21phaHjBvW1er5aY83FVHUsKowfAEBzxzCas6bZV3o8FfFdtUBU/quqDQZf0yV4fwEM/wPRWetdLOSh1LIFUWp8nyXPBNGQ7dUOfpd12u0bh1DLrpoHf1XjyLwXTDk2WAQFuPiAKG2hb07S+U/CkOrLtZKugtwAwYRKEGIoHJAt8QWimtRrL/zVtB7Pfjs9FDq16CHzD964W8x/3U5QwKMoZkpiHbDEwzKWJgHnIWyD5UeyjL60nVYEwoC7yUB49PL/ozg9AEHpRlvv/sgl0+G0QoBocd+EM/gtbC3FGCNNmBQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"token\" title=\"token\" src=\"/static/dc1c10a1ce146d0c95b1328a0b2dc02a/03e1f/token.png\" srcset=\"/static/dc1c10a1ce146d0c95b1328a0b2dc02a/12f09/token.png 148w,\n/static/dc1c10a1ce146d0c95b1328a0b2dc02a/e4a3f/token.png 295w,\n/static/dc1c10a1ce146d0c95b1328a0b2dc02a/03e1f/token.png 489w\" sizes=\"(max-width: 489px) 100vw, 489px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<p>7.3 (Tokenizer + Filter) 대신 Analyzer 사용</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">GET library/_analyze\n<span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"standard\"</span><span class=\"token punctuation\">,</span>\n   <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Brown fox brown dog\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ol>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>reference</h2>\n<p><a href=\"https://www.elastic.co\">elastic 공식 홈페이지</a></p>","frontmatter":{"title":"Elastic이란","date":"June 23, 2019"}}},"pageContext":{"slug":"/Elasticsearch/elastic이란/","previous":{"fields":{"slug":"/nginx/nginx란/"},"frontmatter":{"title":"Nginx란","category":"nginx"}},"next":{"fields":{"slug":"/css/3d-card/"},"frontmatter":{"title":"3d-card","category":"css"}}}}}